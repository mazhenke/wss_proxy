# WSS Shadowsocks 插件 - 使用说明（精简版）

## 适用场景

本仓库提供一个基于 WSS 的 SIP003 插件（客户端/服务端）以及加扰器。仅做教学与内网测试，未进行生产级安全加固。

## 当前能力与限制

- 配置入口：仅支持 SIP003 环境变量 `SS_REMOTE_HOST/PORT`、`SS_LOCAL_HOST/PORT`、`SS_PLUGIN_OPTIONS`。
- TLS：
  - 服务端从 `SS_PLUGIN_OPTIONS` 读取 `cert`、`key` 载入证书。
  - 客户端强制关闭证书校验，传入 `cert` 只会记录日志，不会启用校验。
- WSS 路径固定 `/ws`；加扰密钥固定 `wss_plugin_default_key`，均不可配置。

## 文件速览

- wss_plugin_client.py / wss_plugin_server.py — 核心客户端、服务端。
- obfuscator.py — 加扰器，可单独运行验证。
- build_executable.py — PyInstaller 打包脚本。
- tests/ — 本地测试脚本与说明（generate_cert.py、start_echo_server.py、start_plugin_server.py、start_plugin_client.py、test_data_transfer.py）。

## 本地快速验证（四个终端）

在 `tests/` 目录下：

1. 生成证书：`./generate_cert.py --domain localhost`
2. 后端 Echo：`./start_echo_server.py --host 127.0.0.1 --port 8388`
3. 启动服务端：`./start_plugin_server.py --backend-host 127.0.0.1 --backend-port 8388 --listen-host 127.0.0.1 --listen-port 8443 --cert fullchain.pem --key privkey.pem`
4. 启动客户端：`./start_plugin_client.py --remote-host 127.0.0.1 --remote-port 8443 --local-port 1080`
5. 另开终端验收：`./test_data_transfer.py --verbose`

## 数据加扰概览

1. 随机填充 1–15 字节并附 2 字节原始长度。
2. 使用固定密钥流做 XOR（偏移 = 原始长度 % 256）。
3. 以 4 字节为块反转顺序。

## 注意事项

- 客户端关闭证书校验，生产环境需自行修改代码后再部署。
- 加扰仅做混淆，不提供加密保障；敏感流量仍依赖 TLS。
- 端口若冲突，可通过各脚本参数调整 8388/8443/1080。

## 更多信息

详见 [README_wss_plugin.md](README_wss_plugin.md) 与 [QUICKSTART.md](QUICKSTART.md)。
